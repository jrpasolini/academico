10 CLS
20 DIM T(3,3)
30 FOR I=1 TO 3: FOR J=1 TO 3: T(I,J)=0: NEXT J: NEXT I
40 P=1
50 GOSUB 200
60 PRINT "Jogador ";P;" - Escolha linha (1-3): ";
70 INPUT L
80 IF L<1 OR L>3 THEN PRINT "Linha inválida": GOTO 60
90 PRINT "Jogador ";P;" - Escolha coluna (1-3): ";
100 INPUT C
110 IF C<1 OR C>3 THEN PRINT "Coluna inválida": GOTO 90
120 IF T(L,C)<>0 THEN PRINT "Posição ocupada!": GOTO 60
130 T(L,C)=P
140 GOSUB 200
150 GOSUB 300
160 IF V<>0 THEN PRINT "Jogador ";V;" venceu!": END
170 S=0: FOR I=1 TO 3: FOR J=1 TO 3: IF T(I,J)<>0 THEN S=S+1
180 NEXT J: NEXT I
190 IF S=9 THEN PRINT "Empate!": END
195 P=3-P: GOTO 60

200 REM --- DESENHA TABULEIRO ---
210 CLS
220 PRINT " Jogo da Velha"
230 FOR I=1 TO 3
240   FOR J=1 TO 3
250     IF T(I,J)=0 THEN PRINT " . ";
260     IF T(I,J)=1 THEN PRINT " X ";
270     IF T(I,J)=2 THEN PRINT " O ";
280   NEXT J
290   PRINT
300 NEXT I
310 RETURN

300 REM --- VERIFICA VENCEDOR ---
310 V=0
320 FOR I=1 TO 3
330   IF T(I,1)=T(I,2) AND T(I,2)=T(I,3) AND T(I,1)<>0 THEN V=T(I,1): RETURN
340   IF T(1,I)=T(2,I) AND T(2,I)=T(3,I) AND T(1,I)<>0 THEN V=T(1,I): RETURN
350 NEXT I
360 IF T(1,1)=T(2,2) AND T(2,2)=T(3,3) AND T(1,1)<>0 THEN V=T(1,1): RETURN
370 IF T(1,3)=T(2,2) AND T(2,2)=T(3,1) AND T(1,3)<>0 THEN V=T(1,3): RETURN
380 RETURN